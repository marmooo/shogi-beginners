loadConfig();let japaneseVoices=[];loadVoices();function loadConfig(){localStorage.getItem("darkMode")==1&&(document.documentElement.dataset.theme="dark"),localStorage.getItem("voice")!=1&&(document.getElementById("voiceOn").classList.add("d-none"),document.getElementById("voiceOff").classList.remove("d-none"))}function toggleVoice(){if(localStorage.getItem("voice")==1)localStorage.setItem("voice",0),document.getElementById("voiceOn").classList.add("d-none"),document.getElementById("voiceOff").classList.remove("d-none");else{localStorage.setItem("voice",1),document.getElementById("voiceOn").classList.remove("d-none"),document.getElementById("voiceOff").classList.add("d-none"),speechSynthesis.cancel();const a=new SpeechSynthesisUtterance("音声読み上げを開始します。");return a.lang="ja-JP",a.voice=japaneseVoices[Math.floor(Math.random()*japaneseVoices.length)],speechSynthesis.speak(a),a}}function toggleDarkMode(){localStorage.getItem("darkMode")==1?(localStorage.setItem("darkMode",0),delete document.documentElement.dataset.theme):(localStorage.setItem("darkMode",1),document.documentElement.dataset.theme="dark")}function loadVoices(){const a=new Promise(function(b){let a=speechSynthesis.getVoices();a.length!==0?b(a):speechSynthesis.addEventListener("voiceschanged",function(){a=speechSynthesis.getVoices(),b(a)})});a.then(a=>{japaneseVoices=a.filter(a=>a.lang=="ja-JP")})}function getText(b){let a="";return[...b.childNodes].forEach(b=>{b.nodeType==b.TEXT_NODE?a+=b.wholeText:b.tagName=="RUBY"&&[...b.getElementsByTagName("rt")].forEach(b=>{a+=b.innerText})}),a}document.getElementById("toggleDarkMode").onclick=toggleDarkMode,document.getElementById("toggleVoice").onclick=toggleVoice