loadConfig();let japaneseVoices=[];loadVoices();function loadConfig(){localStorage.getItem("darkMode")==1&&document.documentElement.setAttribute("data-bs-theme","dark"),localStorage.getItem("voice")!=1&&(document.getElementById("voiceOn").classList.add("d-none"),document.getElementById("voiceOff").classList.remove("d-none"))}function toggleDarkMode(){localStorage.getItem("darkMode")==1?(localStorage.setItem("darkMode",0),document.documentElement.setAttribute("data-bs-theme","light")):(localStorage.setItem("darkMode",1),document.documentElement.setAttribute("data-bs-theme","dark"))}function toggleVoice(){if(localStorage.getItem("voice")==1)localStorage.setItem("voice",0),document.getElementById("voiceOn").classList.add("d-none"),document.getElementById("voiceOff").classList.remove("d-none");else{localStorage.setItem("voice",1),document.getElementById("voiceOn").classList.remove("d-none"),document.getElementById("voiceOff").classList.add("d-none"),speechSynthesis.cancel();const e=new SpeechSynthesisUtterance("音声読み上げを開始します。");return e.lang="ja-JP",e.voice=japaneseVoices[Math.floor(Math.random()*japaneseVoices.length)],speechSynthesis.speak(e),e}}function loadVoices(){const e=new Promise(function(e){let t=speechSynthesis.getVoices();t.length!==0?e(t):speechSynthesis.addEventListener("voiceschanged",function(){t=speechSynthesis.getVoices(),e(t)})});e.then(e=>{japaneseVoices=e.filter(e=>e.lang=="ja-JP")})}function getText(e){let t="";return[...e.childNodes].forEach(e=>{e.nodeType==e.TEXT_NODE?t+=e.wholeText:e.tagName=="RUBY"&&[...e.getElementsByTagName("rt")].forEach(e=>{t+=e.innerText})}),t}document.getElementById("toggleDarkMode").onclick=toggleDarkMode,document.getElementById("toggleVoice").onclick=toggleVoice